<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Print data return </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* ==================== BODY/SCREEN STYLES ==================== */
   * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f3f4f6;
            color: #374151;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 2rem;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e5e7eb;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 1.125rem;
            color: #6b7280;
        }

        .form-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background-color: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .input-group label {
            font-weight: 600;
            color: #4b5563;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .input-group input, .input-group select {
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            width: 100%;
            transition: border-color 0.2s, box-shadow 0.2s;
            font-family: 'Sarabun', sans-serif;
            font-size: 1rem;
        }
        
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.25);
        }

        .button-group {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn-primary {
            background-color: #3b82f6;
            color: #ffffff;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-family: 'Sarabun', sans-serif;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            font-size: 1rem;
        }
        
        .btn-primary:hover {
            background-color: #2563eb;
            transform: translateY(-1px);
        }
        
        .btn-primary:active {
            transform: translateY(0);
        }
        
        .btn-print {
            background-color: #10b981;
            color: #ffffff;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            font-family: 'Sarabun', sans-serif;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
            box-shadow: 0 2px 4px -1px rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.06);
            font-size: 0.875rem;
        }
        
        .btn-print:hover {
            background-color: #059669;
            transform: translateY(-1px);
        }
        
        .btn-print:active {
            transform: translateY(0);
        }
        
        .group-header {
            background-color: #e0f2fe;
            padding: 1rem;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.25rem;
            font-weight: 700;
            color: #1e40af;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        
        .no-results {
            text-align: center;
            padding: 2rem;
            font-size: 1.125rem;
            color: #6b7280;
            background-color: #f9fafb;
            border-radius: 8px;
            border: 2px dashed #d1d5db;
        }
        
        .loading-indicator {
            text-align: center;
            padding: 2rem;
            font-size: 1.125rem;
            color: #6b7280;
            display: none;
        }

        .loading-indicator.show {
            display: block;
        }
        
        /* Screen table styles */
        .screen-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .screen-table th, .screen-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .screen-table th {
            background-color: #f9fafb;
            font-weight: 600;
            color: #4b5563;
            text-transform: uppercase;
            font-size: 0.875rem;
            letter-spacing: 0.05em;
        }
        
        .screen-table tr:nth-child(even) {
            background-color: #f9fafb;
        }
        
        .screen-table tr:hover {
            background-color: #eff6ff;
            transition: background-color 0.2s;
        }

        .screen-table td {
            font-size: 0.9rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background-color: #ffffff;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            border-left: 4px solid #3b82f6;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #1e40af;
        }

        .stat-label {
            font-size: 0.875rem;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        @media (max-width: 768px) {
            .container {
                margin: 1rem;
                padding: 1rem;
            }

            .header h1 {
                font-size: 2rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
                align-items: center;
            }

            .screen-table {
                font-size: 0.875rem;
            }

            .screen-table th, .screen-table td {
                padding: 0.75rem 0.5rem;
            }
        }

        /* ==================== PRINT STYLES ==================== */
        @media print {
            @page {
                size: A4;
                margin: 15mm 10mm;
            }
            
            * {
                box-shadow: none !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                font-family: 'Sarabun', sans-serif !important;
            }
            
            body * {
                visibility: hidden;
            }
            
            .printable-area, .printable-area * {
                visibility: visible;
                color: #000 !important;
            }
            
            .printable-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                padding: 0;
                background-color: white !important;
                border: none;
                border-radius: 0;
            }

            /* Hide screen elements */
            .btn-print,
            .group-header {
                display: none !important;
            }

            /* Show print elements */
            .print-only {
                display: block !important;
            }
            
            .print-header {
                text-align: center;
                margin-bottom: 30px;
                padding-bottom: 20px;
                border-bottom: 2px solid #000;
            }
            
            .print-logo {
                max-height: 40px;
                width: auto;
                margin-bottom: 15px;
            }
            
            .print-company-info {
                font-family: 'Sarabun', sans-serif;
                font-size: 14px;
                line-height: 1.4;
                margin-bottom: 15px;
            }
            
            .print-company-name {
                font-family: 'Sarabun', sans-serif;
                font-size: 24px;
                font-weight: 700;
                color: #000;
                margin-bottom: 10px;
            }
            
            .print-document-title {
                font-size: 20px;
                font-weight: 600;
                color: #000;
                margin: 20px 0;
                text-decoration: underline;
            }
            
            .print-invoice-info {
                display: flex;
                justify-content: space-between;
                margin-bottom: 25px;
                font-size: 14px;
            }
            
            .print-invoice-left,
            .print-invoice-right {
                width: 48%;
            }
            
            .print-invoice-info p {
                margin: 5px 0;
                line-height: 1.3;
            }
            
            .print-invoice-info strong {
                font-weight: 600;
                min-width: 100px;
                display: inline-block;
            }
            
            /* Print table styles */
            .print-table {
                width: 100%;
                border-collapse: collapse;
                margin: 20px 0;
                border: 2px solid #000;
            }
            
            .print-table th, 
            .print-table td {
                border: 1px solid #000;
                padding: 8px 6px;
                text-align: center;
                font-size: 12px;
                line-height: 1.2;
                vertical-align: middle;
                background-color: white !important;
            }
            
            .print-table th {
                font-weight: 600;
                color: #000 !important;
                font-size: 11px;
                text-transform: uppercase;
            }
            
            .print-table .text-left {
                text-align: left !important;
            }
            
            .print-summary {
                margin-top: 25px;
                padding: 15px;
                border: 2px solid #000;
                background-color: #f9f9f9 !important;
                font-size: 14px;
            }
            
            .print-summary-row {
                display: flex;
                justify-content: space-between;
                margin: 8px 0;
            }
            
            .print-summary strong {
                font-weight: 600;
            }
            
            .print-signatures {
                display: flex;
                justify-content: space-between;
                margin-top: 40px;
                text-align: center;
                font-size: 14px;
            }
            
            .signature-box {
                width: 30%;
                text-align: center;
            }
            
            .signature-line {
                border-top: 2px solid #000;
                margin-top: 50px;
                padding-top: 8px;
                font-weight: 500;
            }
            
            .print-footer {
                margin-top: 30px;
                text-align: center;
                font-size: 12px;
                color: #666;
                border-top: 1px solid #ccc;
                padding-top: 15px;
            }
            
            .print-date {
                text-align: right;
                margin-top: 20px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
          <h1 class="text-3xl font-bold text-center mb-6 text-gray-800">📊 Data Return Tracking</h1>
          <p class="text-center text-gray-600">Filter and view your data with Return Tracking</p><br>
      <hr class="border-t border-green-600"></hr>
      <br>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
            <div class="input-group">
                <label for="idInput" class="block text-sm mb-1">ID:</label>
                <input type="text" id="idInput" placeholder="กรอก ID" >
            </div>
            <div class="input-group">
                <label for="trackingInput" class="block text-sm mb-1">Tracking:</label>
                <input type="text" id="trackingInput" placeholder="กรอก Tracking">
            </div>
            <div class="input-group">
                <label for="sellerInput" class="block text-sm mb-1">Seller:</label>
                <input type="text" id="sellerInput" placeholder="กรอก Seller">
            </div>
            <div class="input-group">
                <label for="transportInput" class="block text-sm mb-1">Transport:</label>
                <input type="text" id="transportInput" placeholder="กรอก Transport">
            </div>
        </div>

        <div class="flex justify-center mb-8">
            <button id="searchButton" class="btn-primary">ค้นหาข้อมูล</button>
        </div>

        <div id="loadingIndicator" class="loading-indicator">
            กำลังโหลดข้อมูล... โปรดรอสักครู่
        </div>

        <div id="resultsContainer">
        </div>
    </div>

    <script>
        // ** สำคัญ: แทนที่ YOUR_WEB_APP_URL_HERE ด้วย URL ของ Google Apps Script Web App ของคุณ **
        const GAS_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwDpPyO8S8KG41VTaVToM041VrTjBW-Pt133rLCJrPPpPurVqrjhXnLG72LU3jBNBpu6g/exec'; // <--- แทนที่ตรงนี้!
        
        // ** สำคัญ: แทนที่ URL_TO_YOUR_LOGO.png ด้วย URL รูปภาพโลโก้ของคุณ **
        const LOGO_URL = 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/c6/Lotus%27s_Logo.svg/1200px-Lotus%27s_Logo.svg.png'; // <--- แทนที่ตรงนี้!

        const idInput = document.getElementById('idInput');
        const trackingInput = document.getElementById('trackingInput');
        const sellerInput = document.getElementById('sellerInput');
        const transportInput = document.getElementById('transportInput');
        const searchButton = document.getElementById('searchButton');
        const resultsContainer = document.getElementById('resultsContainer');
        const loadingIndicator = document.getElementById('loadingIndicator');

        /**
         * Fetches data from the Google Apps Script API based on search criteria.
         */
        async function fetchData() {
            resultsContainer.innerHTML = ''; // Clear previous results
            loadingIndicator.style.display = 'block'; // Show loading indicator
            searchButton.disabled = true; // Disable button during fetch

            const params = new URLSearchParams();
            if (idInput.value) params.append('ID', idInput.value);
            if (trackingInput.value) params.append('Tracking', trackingInput.value);
            if (sellerInput.value) params.append('Seller', sellerInput.value);
            if (transportInput.value) params.append('Transport', transportInput.value);

            const url = `${GAS_WEB_APP_URL}?${params.toString()}`;

            try {
                const response = await fetch(url);
                const data = await response.json();

                if (response.ok) {
                    if (data.error) {
                        displayMessage(`เกิดข้อผิดพลาด: ${data.error}`, 'error');
                    } else {
                        displayData(data);
                    }
                } else {
                    displayMessage(`API Error: ${data.error || 'ไม่สามารถเชื่อมต่อกับ API ได้'}`, 'error');
                }
            } catch (error) {
                console.error('Error fetching data:', error);
                displayMessage(`เกิดข้อผิดพลาดในการดึงข้อมูล: ${error.message}`, 'error');
            } finally {
                loadingIndicator.style.display = 'none'; // Hide loading indicator
                searchButton.disabled = false; // Enable button
            }
        }

        /**
         * Displays a message in the results container.
         * @param {string} message The message to display.
         * @param {string} type The type of message (e.g., 'info', 'error').
         */
        function displayMessage(message, type = 'info') {
            resultsContainer.innerHTML = `
                <div class="no-results ${type === 'error' ? 'text-red-600' : 'text-gray-600'}">
                    ${message}
                </div>
            `;
        }

        /**
         * Get current date in Thai format
         */
        function getCurrentDateThai() {
            const now = new Date();
            const options = {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                timeZone: 'Asia/Bangkok'
            };
            return now.toLocaleDateString('th-TH', options);
        }
      
        /**
         * Get current time in 24-hour format
         */
        function getCurrentTime() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            return `${hours}:${minutes}`;
        }

        /**
         * Displays the fetched data, grouped by ID, with print buttons.
         * @param {Array<Object>} data The array of data objects from the API.
         */
        function displayData(data) {
            resultsContainer.innerHTML = ''; // Clear previous results

            if (data.length === 0) {
                displayMessage('ไม่พบข้อมูลที่ตรงกับเงื่อนไขการค้นหา');
                return;
            }

            // Group data by ID
            const groupedData = data.reduce((acc, item) => {
                const id = item.ID;
                if (!acc[id]) {
                    acc[id] = [];
                }
                acc[id].push(item);
                return acc;
            }, {});

            for (const id in groupedData) {
                const group = groupedData[id];
                const groupId = `group-${id.replace(/[^a-zA-Z0-9]/g, '-')}`;

                // Group by Tracking and sum Qty
                const summedByTracking = group.reduce((acc, item) => {
                    const tracking = item.Tracking;
                    if (!acc[tracking]) {
                        acc[tracking] = { ...item, Qty: 0 };
                    }
                    acc[tracking].Qty += (parseInt(item.Qty) || 0);
                    return acc;
                }, {});

                const uniqueTrackingItems = Object.values(summedByTracking);
                let totalQty = uniqueTrackingItems.reduce((sum, item) => sum + (parseInt(item.Qty) || 0), 0);
                
                // Get transport info from the first item in the group
                const transportInfo = uniqueTrackingItems.length > 0 ? uniqueTrackingItems[0].Transport : '';
                
                const groupDiv = document.createElement('div');
                groupDiv.id = groupId;
                groupDiv.classList.add('printable-area', 'mb-8', 'p-4', 'border', 'border-gray-200', 'rounded-lg', 'bg-white');

                // Screen table rows
                const screenTableRows = uniqueTrackingItems.map((item, index) => {
                    return `
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${index + 1}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.Tracking}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.Seller}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.Transport}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.Category}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.Qty}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.Timestamp}</td>
                        </tr>
                    `;
                }).join('');

                // Print table rows
                const printTableRows = uniqueTrackingItems.map((item, index) => {
                    return `
                        <tr>
                            <td>${index + 1}</td>
                            <td class="text-left">${item.Tracking}</td>
                            <td class="text-left">${item.Seller}</td>
                            <td class="text-left">${item.Transport}</td>
                            <td class="text-left">${item.Category}</td>
                            <td>${item.Qty}</td>
                            <td class="text-left">${item.Timestamp}</td>
                        </tr>
                    `;
                }).join('');
                
                groupDiv.innerHTML = `
                    <!-- Screen display header -->
                    <div class="group-header">
                        <span>ID: ${id}</span>
                        <button class="btn-print" onclick="printGroup('${groupId}')">PRINT</button>
                    </div>

                    <!-- Screen table -->
                    <table class="screen-table min-w-full divide-y divide-gray-200 rounded-lg overflow-hidden">
                        <thead>
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ลำดับ</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tracking</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Seller</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Transport</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Qty</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Timestamp</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            ${screenTableRows}
                        </tbody>
                    </table>

                    <!-- Print-only header -->
                    <div class="print-only" style="display: none;">
                        <div class="print-header">
                            <center><img src="${LOGO_URL}" alt="Company Logo" class="print-logo"></center>
                            <div class="print-company-info"><b Style="font-size: 20px;">ศูนย์กระจายสินค้าโลตัสวังน้อย</b></div>
                            <div class="print-company-info">
                                188/1 หมู่.4 ถ.พหลโยธิน ต.ลำไทร อ.วังน้อย จ.พระนครศรีอยุธยา 13170 <br>
                                โทร: 096-829-7646 | โทรสาร: 035-315400-365 | แฟกซ์: 035-315400-365
                            </div>
                        </div>
                        
                        <center><h2 class="print-document-title">ใบรายการรับสินค้าตีกลับ / RETURN LIST</h2></center>
                        
                        <div class="print-invoice-info">
                            <div class="print-invoice-left">
                                <p><strong>เลขที่เอกสาร/Doc number:</strong> WNDC7888-${id}</p>
                                <p><strong>รหัสอ้างอิง/Ref number:</strong> ${id}</p>
                            </div>
                            <div class="print-invoice-right">
                                <p><strong>วันที่/Date:</strong> ${getCurrentDateThai()}</p>
                                <p><strong>ขนส่ง/Transport:</strong> ${transportInfo}</p>
                            </div>
                        </div>
                    </div>

                    <!-- Print table -->
                    <table class="print-only print-table" style="display: none;">
                        <thead>
                            <tr>
                                <th style="width: 8%;">No</th>
                                <th style="width: 20%;">Tracking Number</th>
                                <th style="width: 18%;">Seller</th>
                                <th style="width: 15%;">Transport</th>
                                <th style="width: 15%;">Category</th>
                                <th style="width: 10%;">Qty</th>
                                <th style="width: 18%;">Timestamp</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${printTableRows}
                        </tbody>
                    </table>
                    
                    <!-- Print-only summary -->
                    <div class="print-only print-summary" style="display: none;">
                        <div class="print-summary-row">
                            <span>จำนวนรายการทั้งหมด:</span>
                            <strong>${uniqueTrackingItems.length} รายการ</strong>
                        </div>
                        <div class="print-summary-row">
                            <span>จำนวน Quantity รวม:</span>
                            <strong>${totalQty} กล่อง</strong>
                        </div>
                        <div class="print-summary-row">
                            <span Style="font-size: 10px;">**เอกสารนี้จัดทำเพื่อเป็นการยืนยันการคืนสินค้าและการตรวจสอบสินค้าระหว่าง QC Lotus ร่วมกับพนักงานขนส่งสินค้า Return หากมีความเสียหายเกิดขึ้นกับสินค้า ขนส่งยินยอมให้ทำการ Reject และ Claim ทุกกรณี**</span>
                        </div>
                    </div>
                    <!-- Print-only signatures -->
                    <div class="print-only print-signatures" style="display: none;">
                      <div class="print-invoice-info">
                            <div class="print-invoice-left">
                                <p><strong>________________________________________________</strong></p>
                                <p><strong>พนักงานรับสินค้า/Receiver</strong></p>
                                <p><strong>${getCurrentDateThai()}</strong></p>
                                <p><strong>${getCurrentTime()}</strong></p>
                            </div>
                            
                            <div class="print-invoice-right">
                                <p><strong>________________________________________________</strong></p>
                                <p><strong>พนักงานขนส่ง/Transport</strong></p>
                                <p><strong>${getCurrentDateThai()}</strong></p>
                                <p><strong>${getCurrentTime()}</strong></p>
                                
                            </div>
                            </div>
                        </div>
                    </div>
                `;
                resultsContainer.appendChild(groupDiv);
            }
        }

        /**
         * Prints a specific group of data.
         * @param {string} groupId The ID of the HTML element containing the group to print.
         */
        function printGroup(groupId) {
            const printContent = document.getElementById(groupId);
            if (!printContent) {
                console.error('Print content not found for ID:', groupId);
                return;
            }

            // Hide all screen elements and show only print elements
            const screenElements = printContent.querySelectorAll('.group-header, .screen-table');
            const printElements = printContent.querySelectorAll('.print-only');
            
            // Hide screen elements
            screenElements.forEach(element => {
                element.style.display = 'none';
            });
            
            // Show print elements
            printElements.forEach(element => {
                element.style.display = 'block';
            });

            // Use the print functionality
            window.print();
            
            // After printing, restore the original display
            setTimeout(() => {
                // Show screen elements
                screenElements.forEach(element => {
                    element.style.display = '';
                });
                
                // Hide print elements
                printElements.forEach(element => {
                    element.style.display = 'none';
                });
            }, 100);
        }

        // Event listener for the search button
        searchButton.addEventListener('click', fetchData);

        // Optional: Fetch data on page load (if you want to show all data initially)
        // fetchData();
    </script>
</body>
</html>
